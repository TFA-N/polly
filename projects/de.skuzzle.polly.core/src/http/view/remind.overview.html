#if ($snoozable)
<div class="highlight contentBox" id="showSnooze">
    #CONTENT_HEADER ("Snoozable Remind for you")
    <div class="content">
    <table style="table-layout: fixed;">
        <tr>
            <th>From</th>
            <th style="width: 30%">Message</th>
            <th>Left</th>
            <th style="width: 50%">Snooze</th>
        </tr>
        
        <tr>
            <td>$snoozable.getFromUser()</td>
            <td>$snoozable.getMessage()</td>
            <td>$myPolly.formatting().formatDate($snoozable.getLeaveDate())</td>
            <td>
                <input 
                    type="text" 
                    class="textbox" 
                    id="snooze_input"
                    placeholder="Insert polly date expression" 
                    style="width: 50%"
                 />
                <input type="button" class="button" value="Set" onclick="setInputSnooze()" title="Snooze by expression"/>
                <input type="button" class="button" value="$runtime" onclick="setSnooze('$runtime')" title="Snooze by remind runtime"/>
                <input type="button" class="button" value="$defaultRemindTime" onclick="setSnooze('$defaultRemindTime')" title="Snooze by default remind time"/>
                <input type="button" class="button" value="Discard" onclick="discardSnooze()" title="Discard this remind"/>
            </td>
            
        </tr>
    </table>
    </div>
</div>
#end


<script>
function setInputSnooze() {
    var expression = encodeURIComponent($("#snooze_input").val())
    setSnooze(expression);
}
function setSnooze(timespan) {
    $.get("$PAGE_SETSNOOZE?timespan="+timespan, function(data) {
        var result = JSON.parse(data);
        if (!result.success) {
            $("#snooze_input").val(result.message);
            $("#snooze_input").select();
        } else {
            $("#showSnooze").fadeOut();
            loadTable("/api/allReminds", "allReminds")
            loadTable("/api/myReminds?nickname=$user.getName()", "myReminds")
        }
    });
};
function discardSnooze() {
    showProgress();
    $.get("$PAGE_DISCARDSNOOZE", function(data) {
        var result = JSON.parse(data);
        if (result.success) {
            $("#showSnooze").fadeOut();
        }
        stopProgress();
    });
}
</script>

<div class="highlight contentBox">
    #CONTENT_HEADER ("Reminds from- and for you")
    
    <div class="content">
        <table id="myReminds">
        </table>
    </div>
</div>


<div class="highlight contentBox">
    #CONTENT_HEADER ("Admin view - All reminds")
    
    <div class="content">
        <table id="allReminds">
        </table>
    </div>
</div>


<script>
$(document).ready(function() {
	loadTable("/api/allReminds", "allReminds")
	loadTable("/api/myReminds?nickname=$user.getName()", "myReminds")
});

function cancelRemind(id) {
    $.get("$PAGE_CANCELREMIND?remindId="+id, function(data) {
        var result = JSON.parse(data);
        if (result.success) {
            loadTable("/api/allReminds", "allReminds")
            loadTable("/api/myReminds?nickname=$user.getName()", "myReminds")
        } else {
            alert(result.message);
        }
    });
}
</script>