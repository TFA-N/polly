<h2>Capi Training Overview</h2>
#set ( $openDesc = !$openDesc )
#set ( $closedDesc = !$closedDesc )

<h3>Unpaid Trainings</h3>
<table>
    <tr>
        <th><a href="MyTrains?openSortKey=BY_TRAINER&openDesc=$openDesc">Trainer</a></th>
        <th><a href="MyTrains?openSortKey=BY_TYPE&openDesc=$openDesc">Type</a></th>
        <th><a href="MyTrains?openSortKey=BY_FACTOR&openDesc=$openDesc">Factor</a></th>
        <th><a href="MyTrains?openSortKey=BY_COSTS&openDesc=$openDesc">Costs</a></th>
        <th>Weighted Costs</th>
        <th><a href="MyTrains?openSortKey=BY_STARTED&openDesc=$openDesc">Started</a></th>
        <th><a href="MyTrains?openSortKey=BY_FINISHED&openDesc=$openDesc">Finished</a></th>
        <th><a href="MyTrains?openSortKey=BY_DURATION&openDesc=$openDesc">Duration</a></th>
    </tr>
    #foreach ($train in $allOpen.getTrains())
    <tr>
        <td>$trainManager.getTrainer($train.getTrainerId()).getName()</td>
        <td>$train.getType()</td>
        <td>$train.getFactor()</td>
        <td>$train.getCosts()</td>
        #set ( $weighted = $train.getFactor()*$train.getCosts() )
        <td>$weighted</td>
        <td>$myPolly.formatting().formatDate($train.getTrainStart())</td>
        <td>$myPolly.formatting().formatDate($train.getTrainFinished())</td>
        #set ( $diff = ($train.getTrainFinished().getTime() - $train.getTrainStart().getTime()) / 1000 )
        <td>$myPolly.formatting().formatTimeSpan($diff)</td>
    </tr>
    #end
    <tr>
        <th></th>
        <th></th>
        <th>Sum</th>
        <th>$allOpen.sum()</th>
        <th>$allOpen.weightedSum()</th>
        <th></th>
        <th></th>
        <th></th>
    </tr>
</table>
    
<h3>Paid Trainings</h3>
<table>
    <tr>
        <th>Trainer</th>
        <th>Type</th>
        <th>Factor</th>
        <th>Costs</th>
        <th>Weighted Costs</th>
        <th>Started</th>
        <th>Finished</th>
        <th>Duration</th>
    </tr>
    #foreach ($train in $allClosed.getTrains())
    <tr>
        <td>$trainManager.getTrainer($train.getTrainerId()).getName()</td>
        <td>$train.getType()</td>
        <td>$train.getFactor()</td>
        <td>$train.getCosts()</td>
        #set ( $weighted = $train.getFactor()*$train.getCosts() )
        <td>$weighted</td>
        <td>$myPolly.formatting().formatDate($train.getTrainStart())</td>
        <td>$myPolly.formatting().formatDate($train.getTrainFinished())</td>
        #set ( $diff = ($train.getTrainFinished().getTime() - $train.getTrainStart().getTime()) / 1000 )
        <td>$myPolly.formatting().formatTimeSpan($diff)</td>
    </tr>
    #end
    <tr>
        <th></th>
        <th></th>
        <th>Sum</th>
        <th>$allClosed.sum()</th>
        <th>$allClosed.weightedSum()</th>
        <th></th>
        <th></th>
        <th></th>
    </tr>
</table>