#set ($dir = !$dir)

<h3>Total drop for shown reports</h3>
<table>
	<tr>
	#foreach ($drop in $totalDrop)
		<th>$!drop.getRessource()</th>
	#end
	</tr>
    <tr>
        <th colspan="14">Total drop</th>
    </tr>
	<tr>
	#foreach ($drop in $totalDrop)
		<td style="text-align:right;">$!drop.getAmount()</td>
	#end
	</tr>
    <tr>
        <th colspan="14">Average drop</th>
    </tr>
	<tr>
	#foreach ($drop in $totalDrop)
#set ($ratio = $drop.getAmount()/$reports.size())
		<td style="text-align:right;">$!ratio</td>
	#end
	</tr>
    <tr>
        <th colspan="14">Max drop</th>
    </tr>
	<tr>
	#foreach ($drop in $dropMax)
		<td style="text-align:right;">$!drop.getAmount()</td>
	#end
	</tr>
    <tr>
        <th colspan="14">Min drop</th>
    </tr>
	<tr>
	#foreach ($drop in $dropMin)
		<td style="text-align:right;">$!drop.getAmount()</td>
	#end
	</tr>
</table>

<p>
<b>Artifacts:</b> $artifacts<br/>
<b>Chance:</b> $chance
</p>

<h3>Statistics for shown reports</h3>
<table style="width:auto">
    <tr>
        <th>Total attacker Captain XP</th>
        <td style="text-align:right;">$!capiXpSumAttacker</td>
    </tr>
    <tr>
        <th>Total attacker Crew XP</th>
        <td style="text-align:right;">$!crewXpSumAttacker</td>
    </tr>
    <tr>
        <th>Total defender Captain XP</th>
        <td style="text-align:right;">$!capiXpSumDefender</td>
    </tr>
    <tr>
        <th>Total defender Crew XP</th>
        <td style="text-align:right;">$!crewXpSumDefender</td>
    </tr>
    <tr>
        <th>Total attacker PZ damage </th>
        <td style="text-align:right;">$!pzDamageAttacker</td>
    </tr>
    <tr>
        <th>Total defender PZ damage </th>
        <td style="text-align:right;">$!pzDamageDefender</td>
    </tr>
</table>

#if ($sortKey)
    $sorter.sort($reports, $sortKey, $dir)
#end


<h3>Reports ($!reports.size())</h3>
<p style="font-size:xx-small; font-weight:bold">(Click Id for detailed info)</p>

<form action="query_reports" method="POST">
<input type="hidden" name="action" value="idSelect"/>
<input type="submit" value="Statistic for selected" class="button"/>
<input type="submit" value="Delete selected" name="delete" class="button"/>
<table>
	<tr>
        <th><input type="checkbox" name="blah" disabled></th>
		<th><a href="$target&sortKey=getId&dir=$dir">Id</a></th>
		<th><a href="$target&sortKey=getQuadrant&dir=$dir">Quadrant</a></th>
		<th><a href="$target&sortKey=getAttackerVenadName&dir=$dir">Attacker</a></th>
		<th><a href="$target&sortKey=getAttackerClan&dir=$dir">Attacker Clan</a></th>
		<th><a href="$target&sortKey=getAttackerKw&dir=$dir">Attacker KW/Xp-Mod</a></th>
		<th><a href="$target&sortKey=getDefenderVenadName&dir=$dir">Defender</a></th>
		<th><a href="$target&sortKey=getDefenderClan&dir=$dir">Defender Clan</a></th>
		<th><a href="$target&sortKey=getDefenderKw&dir=$dir">Defender KW/Xp-Mod</a></th>
		<th><a href="$target&sortKey=getTactic&dir=$dir">Tactic</a></th>
		<th><a href="$target&sortKey=hasArtifact&dir=$dir">Artifact</a></th>
		<th><a href="$target&sortKey=getDate&dir=$dir">Date</a></th>
	</tr>
	#foreach ($report in $reports)
	<tr>
        <td><input type="checkbox" value="$report.getId()" name="selectRP"/></td>
		<td><a href="battlereport_info?id=$report.getId()">$report.getId()</a></td>
		<td><a href="query_reports?action=byLocation&query=$report.getQuadrant()">$report.getQuadrant()</a> $report.getX(),$report.getY()</td>
		<td><a href="query_reports?action=byVenad&query=$report.getAttackerVenadName()">$report.getAttackerVenadName()</a></td>
		<td><a href="query_reports?action=byClan&query=$report.getAttackerClan()">$!report.getAttackerClan()</a></td>
		<td>$myPolly.formatting().formatNumber($report.getAttackerKw()) / $myPolly.formatting().formatNumber($report.getAttackerXpMod())</td>
		<td><a href="query_reports?action=byVenad&query=$report.getDefenderVenadName()">$report.getDefenderVenadName()</a></td>
		<td><a href="query_reports?action=byClan&query=$report.getDefenderClan()">$!report.getDefenderClan()</a></td>
		<td>$myPolly.formatting().formatNumber($report.getDefenderKw()) / $myPolly.formatting().formatNumber($report.getDefenderXpMod())</td>
		<td>$report.getTactic()</td>
		<td>$report.hasArtifact()</td>
		<td>$myPolly.formatting().formatDate($report.getDate())</td>
	</tr>
	#end
</table>
<input type="submit" value="Statistic for selected" name="select" class="button"/>
<input type="submit" value="Delete selected" name="delete" class="button"/>
</form>