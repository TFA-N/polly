#if (!$me)
    #set($noAction = true)
    #parse("webinterface/pages/login.html")
#else
<a href="Users">&lt; back to Users</a>
<h2>Info about $user.getName()</h2>
<table>
    <tr>
        <th>Name:</th>
        <td>$user.getName()</td>
    </tr>
    <tr>
        <th>Nickname:</th>
        <td>$!user.getCurrentNickName()</td>
    </tr>
    <tr>
        <th>Last IRC Action:</th>
        <td>#if ($user.getLastMessageTime() != 0) $formatter.formatDate( $user.getLastMessageTime() ) #end</td>
    </tr>
    <tr>
        <th>Logged in since:</th>
        <td>#if ($user.getLoginTime() != 0) $formatter.formatDate( $user.getLoginTime() ) #end</td>
    </tr>
</table>

#if ($isHome || $isAdmin)
<h3>Set new Password</h3>
<form action="user_info" method="POST">
<table>
    <tr>
        <th>New Password</th>
        <th>Action</th>
    </tr>
    <tr>
        <td><input type="text" name="password" /></td>
        <td><input type="submit" value="Set" class="button"/></td>
    </tr>
</table>
<input type="hidden" name="action" value="setPassword" />
<input type="hidden" name="userName" value="$user.getName()" />
</form>
#end

<h3>User Roles</h3>
#if ($isAdmin)
<table>
    <tr>
        <th><a href="Roles">Roles</a></th>
        <th>Actions</th>
    </tr>
    #foreach ($role in $roles)
    <tr>
        <td>$role</td>
        <td>
            <form name="removeRoleFromUser" action="user_info" method="POST">
            <input type="hidden" name="action" value="removeRole"/> 
            <input type="hidden" name="role" value="$role"/> 
            <input type="hidden" name="userName" value="$user.getName()"/>
            <input #if ($user.isPollyAdmin() && $role == "polly.roles.ADMIN") disabled #end type="submit" value="remove" class="button"/>
            </form>
        </td>
    </tr>
    #end
    <tr>
        <form name="addRoleToUser" action="user_info" method="POST">
        <td><select name="role">#foreach ($role in $allRoles) <option>$role</option>#end</select></td>
        <td>
            <input type="hidden" name="action" value="addRoleToUser"/>
            <input type="hidden" name="userName" value="$user.getName()"/>
            <input type="submit" value="add" class="button" /></td>
        </form>
    </tr>
</table>
#elseif ($isHome)
<table>
    <tr>
        <th><a href="Roles">Roles</a></th>
    </tr>
    #foreach ($role in $roles)
    <tr>
        <td>$role</td>
    </tr>
    #end
</table>
#end

#if ($isHome || $isAdmin)
<h3>Attributes</h3>
<form action="user_info" method="POST">
<table>
    <tr>
        <th>Name</th>
        <th style="width:100%;">Value</th>
        #if ($action == "edit")<th>Defaults</th>#end
    </tr>
    #foreach ($attribute in $user.getAttributeNames())
    <tr>
        <td>$attribute</td>
        #if ($action == "edit")
            <td><input type="text" value="$user.getAttribute($attribute)" name="$attribute" style="width: 100%;"/></td>
            <td><input type="button" onclick="this.form.${attribute}.value='%default%'" value="Default" class="button"/></td>
        #else 
            <td>$server.escapeHtml($user.getAttribute($attribute))</td>
        #end
    </tr>
    #end
</table>
    <input type="hidden" name="userName" value="$user.getName()"/>
#if ($action == "edit")
    <input type="hidden" name="action" value="update"/>
    <input type="submit" value="Update" class="button"/>
#else
    <input type="hidden" name="action" value="edit"/>
    <input type="submit" value="Edit" class="button"/>
#end
</form>
#end
#end